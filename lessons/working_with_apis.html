<!-- This file contains ONLY the content for the "Working with APIs" lesson. -->
<div class="max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-lg">
    <div class="mb-8">
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-4xl font-extrabold text-gray-900">56. Working with APIs (RESTful APIs, HTTP requests)</h1>
            <span
                class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full whitespace-nowrap">Advanced
                Level</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-3 mb-6">
            <div class="bg-gradient-to-r from-indigo-500 to-purple-500 h-3 rounded-full transition-all duration-300"
                style="width: 91.7%"></div>
        </div>
    </div>

    <!-- Why APIs Matter -->
    <section class="mb-8">
        <div class="relative mb-8">
            <div class="absolute -top-6 left-24 z-10">
                <span
                    class="inline-flex items-center justify-center w-10 h-10 bg-indigo-100 bg-opacity-80 backdrop-blur-md border-4 border-indigo-300 shadow-lg rounded-full text-2xl text-indigo-600 transition-transform duration-200 hover:scale-110 animate-fade-in">üåê</span>
            </div>
            <div
                class="bg-gradient-to-br from-indigo-50/80 to-white/80 backdrop-blur-md border-2 border-indigo-200 shadow-xl rounded-2xl p-8 pt-12 animate-fade-in">
                <h2 class="text-2xl font-extrabold mb-4 text-indigo-800 tracking-tight">Why APIs Matter</h2>
                <p class="text-lg leading-relaxed mb-4">
                    APIs (Application Programming Interfaces) let your code interact with other software, services, and
                    data sources. They power everything from weather apps and payment systems to social media bots and
                    cloud platforms. Mastering APIs lets you automate tasks, build integrations, and access vast
                    resources on the web.
                </p>
            </div>
        </div>
    </section>

    <!-- Key Concepts -->
    <section class="mb-8">
        <div class="relative mb-8">
            <div class="absolute -top-6 left-6 z-10">
                <span
                    class="inline-flex items-center justify-center w-14 h-14 bg-blue-100 bg-opacity-80 backdrop-blur-md border-4 border-blue-300 shadow-lg rounded-full text-3xl text-blue-600 transition-transform duration-200 hover:scale-110 animate-fade-in">üí°</span>
            </div>
            <div
                class="bg-gradient-to-br from-blue-50/80 to-white/80 backdrop-blur-md border-2 border-blue-200 shadow-xl rounded-2xl p-8 pt-12 animate-fade-in">
                <h2 class="text-3xl font-extrabold mb-4 text-blue-800 tracking-tight">Key Concepts: RESTful APIs</h2>
                <ul
                    class="list-disc list-inside ml-4 mt-2 text-lg leading-relaxed space-y-2 bg-white/90 border-l-4 border-blue-300 shadow-md rounded-xl p-6 animate-fade-in">
                    <li><strong>REST:</strong> A common API style using HTTP methods (GET, POST, PUT, DELETE) and URLs
                        (endpoints).</li>
                    <li><strong>Endpoint:</strong> A specific URL for an API resource (e.g.,
                        <code>https://api.example.com/users</code>).
                    </li>
                    <li><strong>HTTP Methods:</strong> <code>GET</code> (retrieve), <code>POST</code> (create),
                        <code>PUT</code> (update), <code>DELETE</code> (remove).
                    </li>
                    <li><strong>Status Codes:</strong> <code>200</code> (OK), <code>201</code> (Created),
                        <code>400</code> (Bad Request), <code>401</code> (Unauthorized), <code>404</code> (Not Found),
                        <code>500</code> (Server Error).
                    </li>
                    <li><strong>Headers:</strong> Extra info sent with requests (e.g., <code>Authorization</code>,
                        <code>Content-Type</code>).
                    </li>
                    <li><strong>Authentication:</strong> API keys, bearer tokens, OAuth, etc.</li>
                    <li><strong>Rate Limits:</strong> APIs may restrict how many requests you can make per minute/hour.
                    </li>
                    <li><strong>Pagination:</strong> Large results are split into pages; you must request each page.
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Using requests Library -->
    <section class="mb-8">
        <div class="relative mb-8">
            <div class="absolute -top-6 left-6 z-10">
                <span
                    class="inline-flex items-center justify-center w-14 h-14 bg-green-100 bg-opacity-80 backdrop-blur-md border-4 border-green-300 shadow-lg rounded-full text-3xl text-green-600 transition-transform duration-200 hover:scale-110 animate-fade-in">üîó</span>
            </div>
            <div
                class="bg-gradient-to-br from-green-50/80 to-white/80 backdrop-blur-md border-2 border-green-200 shadow-xl rounded-2xl p-8 pt-12 animate-fade-in">
                <h2 class="text-3xl font-extrabold mb-4 text-green-800 tracking-tight">Python's requests Library</h2>
                <p class="text-lg leading-relaxed mb-4">
                    The <code>requests</code> library makes HTTP requests simple and readable. You can send GET/POST
                    requests, add headers, handle JSON, and more.
                </p>
                <div class="code-editor-example mb-4">
                    <div class="code-editor-bar">
                        <div class="code-editor-dots flex gap-2">
                            <div class="code-editor-dot-red"></div>
                            <div class="code-editor-dot-yellow"></div>
                            <div class="code-editor-dot-green"></div>
                        </div>
                        <span class="text-gray-400 text-xs">basic_get.py</span>
                    </div>
                    <pre><code><span style="color: #ff79c6;">import</span> <span style="color: #8be9fd;">requests</span>

<span style="color: #8be9fd;">response</span> <span style="color: #ff79c6;">=</span> <span style="color: #8be9fd;">requests</span>.<span style="color: #50fa7b;">get</span>(<span style="color: #f1fa8c;">\"https://api.github.com/users/octocat\"</span>)
<span style="color: #ff79c6;">if</span> <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">status_code</span> <span style="color: #ff79c6;">==</span> <span style="color: #bd93f9;">200</span>:
    <span style="color: #8be9fd;">data</span> <span style="color: #ff79c6;">=</span> <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">json</span>()
    <span style="color: #50fa7b;">print</span>(<span style="color: #8be9fd;">data</span>[<span style="color: #f1fa8c;">\"login\"</span>], <span style="color: #8be9fd;">data</span>[<span style="color: #f1fa8c;">\"public_repos\"</span>])
<span style="color: #ff79c6;">else</span>:
    <span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">\"Error:\"</span>, <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">status_code</span>)
</code></pre>
                    <div class="bg-gray-100 p-4 rounded-lg mt-2 text-gray-800 text-sm">
                        <strong>Explanation:</strong> This code sends a GET request to GitHub's API, checks for success,
                        parses the JSON response, and prints the username and number of public repos.
                    </div>
                    <div class="bg-gray-900 p-4 rounded-lg mt-2">
                        <h3 class="text-white font-semibold mb-3">üí° Expected Output:</h3>
                        <pre class="text-green-400 text-sm"><code>octocat 8
</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Example: Sending Data (POST) -->
    <section class="mb-8">
        <div class="relative mb-8">
            <div class="absolute -top-6 left-6 z-10">
                <span
                    class="inline-flex items-center justify-center w-14 h-14 bg-pink-100 bg-opacity-80 backdrop-blur-md border-4 border-pink-300 shadow-lg rounded-full text-3xl text-pink-600 transition-transform duration-200 hover:scale-110 animate-fade-in">üì§</span>
            </div>
            <div
                class="bg-gradient-to-br from-pink-50/80 to-white/80 backdrop-blur-md border-2 border-pink-200 shadow-xl rounded-2xl p-8 pt-12 animate-fade-in">
                <h2 class="text-3xl font-extrabold mb-4 text-pink-800 tracking-tight">Example: Sending Data (POST)</h2>
                <div class="code-editor-example mb-4">
                    <div class="code-editor-bar">
                        <div class="code-editor-dots flex gap-2">
                            <div class="code-editor-dot-red"></div>
                            <div class="code-editor-dot-yellow"></div>
                            <div class="code-editor-dot-green"></div>
                        </div>
                        <span class="text-gray-400 text-xs">post_example.py</span>
                    </div>
                    <pre><code><span style="color: #ff79c6;">import</span> <span style="color: #8be9fd;">requests</span>

<span style="color: #8be9fd;">url</span> <span style="color: #ff79c6;">=</span> <span style="color: #f1fa8c;">\"https://httpbin.org/post\"</span>
<span style="color: #8be9fd;">data</span> <span style="color: #ff79c6;">=</span> {<span style="color: #f1fa8c;">\"name\"</span>: <span style="color: #f1fa8c;">\"Alice\"</span>, <span style="color: #f1fa8c;">\"score\"</span>: <span style="color: #bd93f9;">42</span>}
<span style="color: #8be9fd;">response</span> <span style="color: #ff79c6;">=</span> <span style="color: #8be9fd;">requests</span>.<span style="color: #50fa7b;">post</span>(<span style="color: #8be9fd;">url</span>, <span style="color: #f1fa8c;">json</span><span style="color: #ff79c6;">=</span><span style="color: #8be9fd;">data</span>)
<span style="color: #ff79c6;">if</span> <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">status_code</span> <span style="color: #ff79c6;">==</span> <span style="color: #bd93f9;">200</span>:
    <span style="color: #50fa7b;">print</span>(<span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">json</span>()[<span style="color: #f1fa8c;">\"json\"</span>])
<span style="color: #ff79c6;">else</span>:
    <span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">\"Error:\"</span>, <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">status_code</span>)
</code></pre>
                    <div class="bg-gray-100 p-4 rounded-lg mt-2 text-gray-800 text-sm">
                        <strong>Explanation:</strong> This code sends a POST request with a JSON body to httpbin.org,
                        then prints the echoed data from the response.
                    </div>
                    <div class="bg-gray-900 p-4 rounded-lg mt-2">
                        <h3 class="text-white font-semibold mb-3">üí° Expected Output:</h3>
                        <pre class="text-green-400 text-sm"><code>{
  "name": "Alice",
  "score": 42
}
</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Authentication Example -->
    <section class="mb-8">
        <div class="relative mb-8">
            <div class="absolute -top-6 left-6 z-10">
                <span
                    class="inline-flex items-center justify-center w-14 h-14 bg-yellow-100 bg-opacity-80 backdrop-blur-md border-4 border-yellow-300 shadow-lg rounded-full text-3xl text-yellow-600 transition-transform duration-200 hover:scale-110 animate-fade-in">üîë</span>
            </div>
            <div
                class="bg-gradient-to-br from-yellow-50/80 to-white/80 backdrop-blur-md border-2 border-yellow-200 shadow-xl rounded-2xl p-8 pt-12 animate-fade-in">
                <h2 class="text-3xl font-extrabold mb-4 text-yellow-800 tracking-tight">Authentication: API Keys &
                    Bearer Tokens</h2>
                <div class="code-editor-example mb-4">
                    <div class="code-editor-bar">
                        <div class="code-editor-dots flex gap-2">
                            <div class="code-editor-dot-red"></div>
                            <div class="code-editor-dot-yellow"></div>
                            <div class="code-editor-dot-green"></div>
                        </div>
                        <span class="text-gray-400 text-xs">auth_example.py</span>
                    </div>
                    <pre><code><span style="color: #ff79c6;">import</span> <span style="color: #8be9fd;">requests</span>

<span style="color: #8be9fd;">url</span> <span style="color: #ff79c6;">=</span> <span style="color: #f1fa8c;">\"https://api.example.com/data\"</span>
<span style="color: #8be9fd;">headers</span> <span style="color: #ff79c6;">=</span> {<span style="color: #f1fa8c;">\"Authorization\"</span>: <span style="color: #f1fa8c;">\"Bearer YOUR_TOKEN_HERE\"</span>}
<span style="color: #8be9fd;">response</span> <span style="color: #ff79c6;">=</span> <span style="color: #8be9fd;">requests</span>.<span style="color: #50fa7b;">get</span>(<span style="color: #8be9fd;">url</span>, <span style="color: #f1fa8c;">headers</span><span style="color: #ff79c6;">=</span><span style="color: #8be9fd;">headers</span>)
<span style="color: #ff79c6;">if</span> <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">status_code</span> <span style="color: #ff79c6;">==</span> <span style="color: #bd93f9;">200</span>:
    <span style="color: #50fa7b;">print</span>(<span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">json</span>())
<span style="color: #ff79c6;">else</span>:
    <span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">\"Error:\"</span>, <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">status_code</span>)
</code></pre>
                    <div class="bg-gray-100 p-4 rounded-lg mt-2 text-gray-800 text-sm">
                        <strong>Explanation:</strong> This code shows how to send an API token in the Authorization
                        header. Replace <code>YOUR_TOKEN_HERE</code> with your real token.
                    </div>
                    <div class="bg-gray-900 p-4 rounded-lg mt-2">
                        <h3 class="text-white font-semibold mb-3">üí° Expected Output:</h3>
                        <pre class="text-green-400 text-sm"><code>[...]
</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Pagination & Rate Limits -->
    <section class="mb-8">
        <div class="relative mb-8">
            <div class="absolute -top-6 left-6 z-10">
                <span
                    class="inline-flex items-center justify-center w-14 h-14 bg-purple-100 bg-opacity-80 backdrop-blur-md border-4 border-purple-300 shadow-lg rounded-full text-3xl text-purple-600 transition-transform duration-200 hover:scale-110 animate-fade-in">üìÑ</span>
            </div>
            <div
                class="bg-gradient-to-br from-purple-50/80 to-white/80 backdrop-blur-md border-2 border-purple-200 shadow-xl rounded-2xl p-8 pt-12 animate-fade-in">
                <h2 class="text-3xl font-extrabold mb-4 text-purple-800 tracking-tight">Pagination & Rate Limits</h2>
                <ul class="list-disc list-inside ml-4 mt-2 text-lg leading-relaxed">
                    <li><strong>Pagination:</strong> Many APIs return results in pages. Look for <code>next</code> URLs
                        or <code>page</code> parameters in the response.</li>
                    <li><strong>Rate Limits:</strong> If you get a <code>429 Too Many Requests</code> error, slow down
                        and check the <code>Retry-After</code> header.</li>
                </ul>
                <div class="code-editor-example mb-4 mt-4">
                    <div class="code-editor-bar">
                        <div class="code-editor-dots flex gap-2">
                            <div class="code-editor-dot-red"></div>
                            <div class="code-editor-dot-yellow"></div>
                            <div class="code-editor-dot-green"></div>
                        </div>
                        <span class="text-gray-400 text-xs">pagination_example.py</span>
                    </div>
                    <pre><code><span style="color: #ff79c6;">import</span> <span style="color: #8be9fd;">requests</span>

<span style="color: #8be9fd;">url</span> <span style="color: #ff79c6;">=</span> <span style="color: #f1fa8c;">\"https://api.example.com/items?page=1\"</span>
<span style="color: #8be9fd;">all_items</span> <span style="color: #ff79c6;">=</span> []
<span style="color: #ff79c6;">while</span> <span style="color: #8be9fd;">url</span>:
    <span style="color: #8be9fd;">response</span> <span style="color: #ff79c6;">=</span> <span style="color: #8be9fd;">requests</span>.<span style="color: #50fa7b;">get</span>(<span style="color: #8be9fd;">url</span>)
    <span style="color: #8be9fd;">data</span> <span style="color: #ff79c6;">=</span> <span style="color: #8be9fd;">response</span>.<span style="color: #50fa7b;">json</span>()
    <span style="color: #8be9fd;">all_items</span>.<span style="color: #50fa7b;">extend</span>(<span style="color: #8be9fd;">data</span>[<span style="color: #f1fa8c;">\"results\"</span>])
    <span style="color: #8be9fd;">url</span> <span style="color: #ff79c6;">=</span> <span style="color: #8be9fd;">data</span>.<span style="color: #50fa7b;">get</span>(<span style="color: #f1fa8c;">\"next\"</span>) <span style="color: rgb(162, 162, 162) ;"># Next page URL or None</span>
<span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">\"Total items:\"</span>, <span style="color: #8be9fd;">len</span>(<span style="color: #8be9fd;">all_items</span>))
</code></pre>
                    <div class="bg-gray-100 p-4 rounded-lg mt-2 text-gray-800 text-sm">
                        <strong>Explanation:</strong> This code follows the <code>next</code> link in paginated API
                        results to collect all items.
                    </div>
                    <div class="bg-gray-900 p-4 rounded-lg mt-2">
                        <h3 class="text-white font-semibold mb-3">üí° Expected Output:</h3>
                        <pre class="text-green-400 text-sm"><code>Total items: [...]
</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Error Handling & Best Practices -->
    <section class="mb-8">
        <div class="relative mb-8">
            <div class="absolute -top-6 left-6 z-10">
                <span
                    class="inline-flex items-center justify-center w-14 h-14 bg-red-100 bg-opacity-80 backdrop-blur-md border-4 border-red-300 shadow-lg rounded-full text-3xl text-red-600 transition-transform duration-200 hover:scale-110 animate-fade-in">‚ö†Ô∏è</span>
            </div>
            <div
                class="bg-gradient-to-br from-red-50/80 to-white/80 backdrop-blur-md border-2 border-red-200 shadow-xl rounded-2xl p-8 pt-12 animate-fade-in">
                <h2 class="text-3xl font-extrabold mb-4 text-red-800 tracking-tight">Error Handling & Best Practices
                </h2>
                <ul class="list-disc list-inside ml-4 mt-2 text-lg leading-relaxed">
                    <li>Always check <code>response.status_code</code> and handle errors gracefully.</li>
                    <li>Use <code>try/except</code> for network errors
                        (<code>requests.exceptions.RequestException</code>).</li>
                    <li>Validate and sanitize all input/output data.</li>
                    <li>Respect API rate limits and terms of service.</li>
                    <li>Never hardcode secrets or API keys in code‚Äîuse environment variables.</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Try it Yourself -->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-4 text-green-700 flex items-center">
            <span class="bg-green-100 text-green-600 p-2 rounded-lg mr-3">üß™</span>
            Try it Yourself
        </h2>
        <div class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6 shadow-sm mb-6">
            <p class="text-lg leading-relaxed mb-4">
                Write a Python script that fetches data from a public API (e.g.,
                <code>https://api.agify.io?name=alice</code>), parses the JSON, and prints the result. Add error
                handling for network and HTTP errors.
            </p>
        </div>
        <!-- Code Editor Area -->
        <div id="code-editor-container" class="bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"></div>
        <script type="text/plain" id="default-code">
# This code works in the browser-based editor (Pyodide)
from pyodide.http import pyfetch
import asyncio

async def main():
    response = await pyfetch("https://api.agify.io?name=alice")
    data = await response.json()
    print(data)

asyncio.run(main())
        </script>
    </section>

    <!-- Challenge -->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-4 text-purple-700 flex items-center">
            <span class="bg-purple-100 text-purple-600 p-2 rounded-lg mr-3">üèÜ</span>
            Project Challenge: Multi-API Data Aggregator
        </h2>
        <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border-l-4 border-purple-500">
            <p class="text-lg leading-relaxed mb-4">
                <strong>Scenario:</strong> Build a script that fetches data from two different public APIs (e.g.,
                <code>agify.io</code> and <code>genderize.io</code>), combines the results for a given name, and prints
                a summary. Handle errors, use functions, and document your approach.
            </p>
            <ul class="list-decimal list-inside ml-4 mt-2 text-lg leading-relaxed space-y-2">
                <li>Write functions to fetch from each API (with error handling).</li>
                <li>Combine the results into a single dictionary.</li>
                <li>Print a summary (e.g., "Alice: age 25, gender female").</li>
                <li>Document any issues with API limits or data quality.</li>
            </ul>
            <div class="bg-gray-900 p-4 rounded-lg mt-6">
                <h3 class="text-white font-semibold mb-3">üí° Project Example Output:</h3>
                <pre class="text-green-400 text-sm"><code>Alice: age 25, gender female
</code></pre>
            </div>
            <p class="text-md text-gray-600 mt-4">This project will help you practice real-world API integration, error
                handling, and data aggregation in Python.</p>
        </div>
    </section>

    <!-- Navigation Buttons -->
    <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <a href="#" onclick="loadLesson('lessons/database_access.html')"
            class="flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors duration-200">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Previous: Database Access
        </a>
        <div class="text-gray-600">
            <span class="text-sm">Lesson 56 of 71</span>
        </div>
        <a href="#" onclick="loadLesson('lessons/gui_programming.html')"
            class="flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200">
            Next: GUI Programming
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
    </div>
</div>