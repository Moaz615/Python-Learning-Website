<!-- This file contains ONLY the content for the "Polymorphism and Encapsulation" lesson. -->
<div class="max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-lg">
    <div class="mb-8">
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-4xl font-extrabold text-gray-900">32. Polymorphism and Encapsulation</h1>
            <span class="bg-orange-100 text-orange-800 text-sm font-medium px-3 py-1 rounded-full">Intermediate
                Level</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-3 mb-6">
            <!-- Progress bar: (32-21)/18 = 61.1% for intermediate (lessons 22-39) -->
            <div class="bg-gradient-to-r from-orange-500 to-red-500 h-3 rounded-full transition-all duration-300"
                style="width: 61.1%"></div>
        </div>
    </div>

    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-4 text-gray-800 flex items-center"><span
                class="mr-2">üîÑ</span>Polymorphism: Many Forms</h2>
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mb-8 shadow-sm">
            <p class="text-lg leading-relaxed mb-2">
                As briefly introduced in the <a href="#" data-lesson-path="lessons/intro_to_oop.html"
                    class="text-indigo-600 hover:underline">Intro to OOP</a>, <strong
                    class="text-indigo-600">Polymorphism</strong> is an essential concept in Object-Oriented
                Programming, meaning "many forms." It refers to the ability of objects of different classes to be
                treated as objects of a common type. This allows a single interface to be used for different data types.
            </p>
            <p class="text-lg leading-relaxed mb-4">
                In Python, polymorphism is often achieved through:
            </p>
            <ul class="space-y-4">
                <li class="flex items-start bg-white border-l-4 border-indigo-400 rounded-lg p-4 shadow-sm">
                    <span class="mr-3 mt-1 text-indigo-500 text-xl">‚úÖ</span>
                    <div><strong class="text-indigo-600">Method Overriding:</strong> A child class provides a specific
                        implementation for a method that is already defined in its parent class.</div>
                </li>
                <li class="flex items-start bg-white border-l-4 border-indigo-400 rounded-lg p-4 shadow-sm">
                    <span class="mr-3 mt-1 text-indigo-500 text-xl">‚öôÔ∏è</span>
                    <div><strong class="text-indigo-600">Method Overloading (less common in Python):</strong> Python
                        doesn't support traditional method overloading, but you can achieve similar flexibility using
                        default arguments or variable-length arguments.</div>
                </li>
            </ul>
        </div>
    </section>

    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-4 text-gray-800 flex items-center"><span
                class="mr-2">üîí</span>Encapsulation: Bundling and Hiding</h2>
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mb-8 shadow-sm">
            <p class="text-lg leading-relaxed mb-4">
                <strong class="text-indigo-600">Encapsulation</strong> is the bundling of data (attributes) and the
                methods that operate on that data into a single unit (a class). It also involves restricting direct
                access to some of an object's components, which is known as "data hiding."
            </p>
            <p class="text-lg leading-relaxed mb-4">
                The main benefits of encapsulation are:
            </p>
            <ul class="space-y-4">
                <li class="flex items-start bg-white border-l-4 border-indigo-400 rounded-lg p-4 shadow-sm">
                    <span class="mr-3 mt-1 text-indigo-500 text-xl">üõ°Ô∏è</span>
                    <div><strong class="text-indigo-600">Data Protection:</strong> Prevents external code from directly
                        manipulating an object's internal state, leading to more robust and predictable behavior.</div>
                </li>
                <li class="flex items-start bg-white border-l-4 border-indigo-400 rounded-lg p-4 shadow-sm">
                    <span class="mr-3 mt-1 text-indigo-500 text-xl">üß©</span>
                    <div><strong class="text-indigo-600">Modularity:</strong> Each object is self-contained, making it
                        easier to develop, test, and maintain individual components.</div>
                </li>
                <li class="flex items-start bg-white border-l-4 border-indigo-400 rounded-lg p-4 shadow-sm">
                    <span class="mr-3 mt-1 text-indigo-500 text-xl">üîÑ</span>
                    <div><strong class="text-indigo-600">Flexibility:</strong> You can change the internal
                        implementation of a class without affecting the external code that uses it, as long as the
                        public interface remains the same.</div>
                </li>
            </ul>
            <p class="text-lg leading-relaxed mt-4">
                In Python, encapsulation is achieved by convention. While Python doesn't have strict "private" keywords
                like some other languages, developers use conventions to indicate that an attribute or method is
                intended for internal use only.
            </p>
            <ul class="space-y-4">
                <li class="flex items-start bg-white border-l-4 border-blue-400 rounded-lg p-4 shadow-sm">
                    <span class="mr-3 mt-1 text-blue-500 text-xl">üìù</span>
                    <div><code class="font-mono bg-gray-100 px-1 py-0.5 rounded">_attribute_name</code>: (Single
                        underscore) Conventionally indicates a "protected" attribute, meaning it should not be accessed
                        directly from outside the class, but can be accessed by subclasses.</div>
                </li>
                <li class="flex items-start bg-white border-l-4 border-blue-400 rounded-lg p-4 shadow-sm">
                    <span class="mr-3 mt-1 text-blue-500 text-xl">üîê</span>
                    <div><code class="font-mono bg-gray-100 px-1 py-0.5 rounded">__attribute_name</code>: (Double
                        underscore) Triggers "name mangling," making the attribute harder to access directly from
                        outside the class (though not truly private). This is more about avoiding name clashes in
                        inheritance.</div>
                </li>
            </ul>
        </div>
    </section>

    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-4 text-gray-800 flex items-center"><span class="mr-2">‚úçÔ∏è</span>Polymorphism
            and Encapsulation Example</h2>
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mb-8 shadow-sm">
            <div class="flex items-center mb-3">
                <span class="text-blue-500 text-xl mr-2">üí°</span>
                <h3 class="text-xl font-semibold text-blue-800">Example: <code>Shape</code> Hierarchy with Encapsulated
                    Area</h3>
            </div>
            <div class="code-editor-example mb-4">
                <div class="code-editor-bar">
                    <div class="code-editor-dots flex gap-2">
                        <div class="code-editor-dot-red"></div>
                        <div class="code-editor-dot-yellow"></div>
                        <div class="code-editor-dot-green"></div>
                    </div>
                    <span class="text-gray-400 text-xs">shapes_demo.py</span>
                </div>
                <pre><code><span style="color: #ff79c6;">import</span> <span style="color: #f8f8f2;">math</span>

<span style="color: #6272a4;"># Base class demonstrating polymorphism and encapsulation concepts</span>
<span style="color: #ff79c6;">class</span> <span style="color: #50fa7b;">Shape</span>:
    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">__init__</span>(<span style="color: #f8f8f2;">self</span>, <span style="color: #f8f8f2;">name</span>):
        <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">_name</span> <span style="color: #ff79c6;">=</span> <span style="color: #f8f8f2;">name</span> <span style="color: #6272a4;"># Protected attribute (by convention)</span>

    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">get_name</span>(<span style="color: #f8f8f2;">self</span>):
        <span style="color: #ff79c6;">return</span> <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">_name</span>

    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">area</span>(<span style="color: #f8f8f2;">self</span>):
        <span style="color: #6272a4;"># This method is intended to be overridden by subclasses (polymorphism)</span>
        <span style="color: #ff79c6;">raise</span> <span style="color: #f8f8f2;">NotImplementedError</span>(<span style="color: #f1fa8c;">"Subclass must implement abstract method 'area'"</span>)

<span style="color: #6272a4;"># Child class Circle</span>
<span style="color: #ff79c6;">class</span> <span style="color: #50fa7b;">Circle</span>(<span style="color: #f8f8f2;">Shape</span>):
    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">__init__</span>(<span style="color: #f8f8f2;">self</span>, <span style="color: #f8f8f2;">radius</span>):
        <span style="color: #ff79c6;">super</span>().<span style="color: #50fa7b;">__init__</span>(<span style="color: #f1fa8c;">"Circle"</span>)
        <span style="color: #6272a4;"># Encapsulated attribute for radius - accessed via getter/setter if needed</span>
        <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__radius</span> <span style="color: #ff79c6;">=</span> <span style="color: #f8f8f2;">radius</span> 

    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">area</span>(<span style="color: #f8f8f2;">self</span>):
        <span style="color: #ff79c6;">return</span> <span style="color: #f8f8f2;">math</span>.<span style="color: #f8f8f2;">pi</span> <span style="color: #ff79c6;">*</span> (<span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__radius</span> <span style="color: #ff79c6;">**</span> <span style="color: #bd93f9;">2</span>)

    <span style="color: #6272a4;"># Getter for encapsulated radius</span>
    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">get_radius</span>(<span style="color: #f8f8f2;">self</span>):
        <span style="color: #ff79c6;">return</span> <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__radius</span>

<span style="color: #6272a4;"># Child class Rectangle</span>
<span style="color: #ff79c6;">class</span> <span style="color: #50fa7b;">Rectangle</span>(<span style="color: #f8f8f2;">Shape</span>):
    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">__init__</span>(<span style="color: #f8f8f2;">self</span>, <span style="color: #f8f8f2;">width</span>, <span style="color: #f8f8f2;">height</span>):
        <span style="color: #ff79c6;">super</span>().<span style="color: #50fa7b;">__init__</span>(<span style="color: #f1fa8c;">"Rectangle"</span>)
        <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__width</span> <span style="color: #ff79c6;">=</span> <span style="color: #f8f8f2;">width</span>
        <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__height</span> <span style="color: #ff79c6;">=</span> <span style="color: #f8f8f2;">height</span>

    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">area</span>(<span style="color: #f8f8f2;">self</span>):
        <span style="color: #ff79c6;">return</span> <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__width</span> <span style="color: #ff79c6;">*</span> <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__height</span>

    <span style="color: #6272a4;"># Getter for encapsulated width</span>
    <span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">get_width</span>(<span style="color: #f8f8f2;">self</span>):
        <span style="color: #ff79c6;">return</span> <span style="color: #f8f8f2;">self</span>.<span style="color: #f8f8f2;">__width</span>

<span style="color: #6272a4;"># Demonstrate Polymorphism: a list of different shape objects</span>
<span style="color: #f8f8f2;">shapes</span> <span style="color: #ff79c6;">=</span> [
    <span style="color: #f8f8f2;">Circle</span>(<span style="color: #bd93f9;">5</span>),
    <span style="color: #f8f8f2;">Rectangle</span>(<span style="color: #bd93f9;">4</span>, <span style="color: #bd93f9;">6</span>)
]

<span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">"--- Calculating Areas Polymorphically ---"</span>)
<span style="color: #ff79c6;">for</span> <span style="color: #f8f8f2;">shape</span> <span style="color: #ff79c6;">in</span> <span style="color: #f8f8f2;">shapes</span>:
    <span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">f"The {shape.get_name()} has an area of: {shape.area():.2f}"</span>)

<span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">"\n--- Encapsulation in action ---"</span>)
<span style="color: #f8f8f2;">my_circle</span> <span style="color: #ff79c6;">=</span> <span style="color: #f8f8f2;">Circle</span>(<span style="color: #bd93f9;">7</span>)
<span style="color: #50fa7b;">print</span>(<span style="color: #f1fa8c;">f"Circle radius via getter: {my_circle.get_radius()}"</span>)
<span style="color: #6272a4;"># print(my_circle.__radius) # This would cause an AttributeError due to name mangling</span>
<span style="color: #6272a4;"># print(my_circle._Shape__radius) # This would work, but it's not recommended direct access</span>
                </code></pre>
            </div>
            <div class="bg-gray-900 p-4 rounded-lg">
                <h3 class="text-white font-semibold mb-3">üí° Expected Output:</h3>
                <pre class="text-green-400 text-sm"><code>--- Calculating Areas Polymorphically ---
The Circle has an area of: 78.54
The Rectangle has an area of: 24.00

--- Encapsulation in action ---
Circle radius via getter: 7</code></pre>
            </div>
        </div>
    </section>

    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-4 text-gray-800">üß™ Try it Yourself</h2>
        <p class="text-lg leading-relaxed mb-4">
            Extend the animal example to demonstrate both polymorphism and encapsulation.
        </p>
        <ol class="list-decimal list-inside ml-4 mt-2 text-lg leading-relaxed space-y-2">
            <li>Create an <code>Animal</code> base class with a protected attribute for <code>_sound</code> and a method
                <code>make_sound()</code>.
            </li>
            <li>Create <code>Dog</code> and <code>Cat</code> subclasses that override <code>make_sound()</code> to
                produce their specific sounds.</li>
            <li>In the <code>Dog</code> class, add a private attribute <code>__fur_color</code> and a public method
                <code>get_fur_color()</code> to access it, demonstrating encapsulation.
            </li>
            <li>Create a list of <code>Animal</code> objects (including <code>Dog</code> and <code>Cat</code> instances)
                and loop through them, calling <code>make_sound()</code> on each to show polymorphism.</li>
        </ol>
        <!-- Code Editor Area -->
        <div id="code-editor-container" class="bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"></div>
        <script type="text/plain" id="default-code">
# Your code goes here

# Base Animal class
class Animal:
    def __init__(self, name, sound):
        self._name = name # Protected attribute (convention)
        self._sound = sound # Protected attribute (convention)

    def make_sound(self):
        return f"{self._name} makes a {self._sound} sound."

# Dog subclass demonstrating method overriding and encapsulation
class Dog(Animal):
    def __init__(self, name, breed, fur_color):
        super().__init__(name, "Woof!") # Call parent constructor with default sound
        self.breed = breed
        self.__fur_color = fur_color # Private attribute (name mangling)

    def make_sound(self): # Overriding parent method
        return f"{self._name} ({self.breed}) barks: Woof! Woof!"

    def get_fur_color(self): # Public method to access private attribute
        return self.__fur_color

# Cat subclass demonstrating method overriding
class Cat(Animal):
    def __init__(self, name, favorite_toy):
        super().__init__(name, "Meow!") # Call parent constructor with default sound
        self.favorite_toy = favorite_toy

    def make_sound(self): # Overriding parent method
        return f"{self._name} ({self.favorite_toy} lover) purrs: Meow! Hiss!"

# Create instances of different animal types
animal1 = Animal("Generic Creature", "grunt")
dog1 = Dog("Buddy", "Golden Retriever", "Golden")
cat1 = Cat("Whiskers", "yarn ball")
dog2 = Dog("Lucy", "Poodle", "White")

# Demonstrate Polymorphism: Call make_sound() on different objects
print("--- Polymorphism in action ---")
animals = [animal1, dog1, cat1, dog2]
for animal in animals:
    print(animal.make_sound())

# Demonstrate Encapsulation: Accessing protected/private attributes
print("\n--- Encapsulation in action ---")
print(f"Dog 1's name (protected): {dog1._name}")
print(f"Dog 1's fur color (via public getter): {dog1.get_fur_color()}")
# The following line would cause an AttributeError:
# print(dog1.__fur_color) # Uncomment to see the error
        </script>
    </section>

    <!-- Challenge Section -->
    <section class="mb-8">
        <h2 class="text-2xl font-semibold mb-4 text-orange-700 flex items-center">
            <span class="bg-orange-100 text-orange-600 p-2 rounded-lg mr-3">üèÜ</span>
            Challenge: Advanced Banking System
        </h2>
        <div class="bg-gradient-to-r from-orange-50 to-pink-50 p-6 rounded-lg border-l-4 border-orange-500">
            <p class="text-lg leading-relaxed mb-4">
                <strong>Scenario:</strong> Build a sophisticated banking system for a modern bank. Your system should
                support multiple types of accounts, handle transactions, and generate reports for both personal and
                business clients.
            </p>
            <ul class="list-decimal list-inside ml-4 mt-2 text-lg leading-relaxed space-y-2">
                <li>Support at least three types of accounts: savings, checking, and business.</li>
                <li>Each account must have an account number, balance, and owner name.</li>
                <li>Allow deposits, withdrawals, and interest calculations for all account types.</li>
                <li>Business accounts should have unique features and rules compared to personal accounts.</li>
                <li>Implement a way to manage multiple accounts and process transactions for all of them.</li>
                <li>Include a system for generating different types of reports, such as account summaries and
                    transaction histories.</li>
                <li>Ensure your system is robust, secure, and prevents invalid operations.</li>
                <li>Demonstrate the system with a variety of accounts, transactions, and reports.</li>
            </ul>
            <div class="bg-gray-900 p-4 rounded-lg">
                <h3 class="text-white font-semibold mb-3">üí° Sample Output:</h3>
                <pre class="text-green-400 text-sm"><code>=== Banking System Demo ===

Creating accounts...
Savings Account #1001 created for John Doe
Checking Account #2001 created for Jane Smith
Business Account #3001 created for TechCorp Inc.

=== Processing Transactions ===
Deposited $1000.00 to Savings Account #1001
Withdrew $500.00 from Savings Account #1001
Deposited $2000.00 to Checking Account #2001
Withdrew $2500.00 from Checking Account #2001 (Overdraft used)
Deposited $5000.00 to Business Account #3001
Withdrew $3000.00 from Business Account #3001

=== Interest Calculation ===
Savings Account #1001: Interest calculated: $5.00
Checking Account #2001: No interest (checking account)
Business Account #3001: Interest calculated: $15.00

=== Account Summary Report ===
Account #1001 (Savings): Balance $505.00, Interest Rate 1.0%
Account #2001 (Checking): Balance -$500.00, Overdraft Limit $1000.00
Account #3001 (Business): Balance $2015.00, Business Type: Technology

=== Transaction History ===
Account #1001: 2 transactions, Total fees: $0.00
Account #2001: 2 transactions, Total fees: $25.00
Account #3001: 2 transactions, Total fees: $50.00</code></pre>
            </div>
            <p class="text-md text-gray-600 mt-4">This challenge is open-ended and requires you to design and implement
                the full system. Focus on clarity, structure, and demonstrating advanced OOP concepts.</p>
        </div>
    </section>

    <!-- Navigation Buttons -->
    <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <a href="#" onclick="loadLesson('lessons/constructors_inheritance.html')"
            class="flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors duration-200">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Previous: Constructors and Inheritance
        </a>
        <div class="text-gray-600">
            <span class="text-sm">Lesson 32 of 71</span>
        </div>
        <a href="#" onclick="loadLesson('lessons/dunder_methods.html')"
            class="flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200">
            Next: Dunder (Magic) Methods
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
    </div>
</div>